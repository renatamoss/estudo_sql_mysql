## Consultas SQL: Avançando no SQL com MySQL

#### Projeto de uma query para geração de relatório comparando QUANTIDADE_LIMITE com QUANTIDADE_VENDAS. </br>
Foram utilizado os comandos *CASE WHEN, THEN, ELSE e funções SUM, MAX e DATE_FORMAT*.

~~~
SELECT X.CPF, X.NOME, X.MES_ANO, X.QUANTIDADE_LIMITE,

CASE WHEN (X.QUANTIDADE_LIMITE - X.QUANTIDADE_VENDAS) < 0 THEN 'INVALIDA'
ELSE 'VALIDA' END AS STATUS_VENDA

FROM (
SELECT NF.CPF, TC.NOME, DATE_FORMAT(NF.DATA_VENDA, '%Y -%M') AS MES_ANO, 
SUM(INF.QUANTIDADE) AS QUANTIDADE_VENDAS, 
(TC.VOLUME_DE_COMPRA) AS QUANTIDADE_LIMITE FROM NOTAS_FISCAIS NF

INNER JOIN ITENS_NOTAS_FISCAIS INF
ON NF.NUMERO = INF.NUMERO

INNER JOIN TABELA_DE_CLIENTES TC
ON TC.CPF = NF.CPF

GROUP BY NF.CPF, TC.NOME,  DATE_FORMAT(NF.DATA_VENDA, '%Y -%M')) X;
~~~

*Projeto realizado no Curso de MySQL - Consultas SQL: Avançando no SQL com MySQL - Alura*

